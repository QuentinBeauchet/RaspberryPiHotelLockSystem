import time
import cv2
import numpy as np
import face_recognition
import requests
import nfc
import base64
from nfc.clf import RemoteTarget


def encode_image(current_image):
    encoded_image = face_recognition.face_encodings(
        cv2.cvtColor(current_image, cv2.COLOR_BGR2RGB))[0]
    return encoded_image


def take_picture():
    cap = cv2.VideoCapture(0)
    _, image, = cap.read()
    cap.release()
    img_resized = image
    return img_resized


def recognition(encoded_image):
    for i in range(5):
        img_resized = take_picture()

        encode_face = face_recognition.face_encodings(img_resized)
        if len(encode_face) != 0:
            matches = face_recognition.compare_faces(
                encoded_image, encode_face, 0.5)
            face_dis = face_recognition.face_distance(
                encoded_image, encode_face)
            match_index = np.argmin(face_dis)

            if matches[match_index]:
                return True
    return False


def getRFIDIdentifier():
    while (True):
        target = clf.sense(RemoteTarget('106A'), RemoteTarget(
            '106B'), RemoteTarget('212F'))

        if target is not None:
            rfid_tag = nfc.tag.activate(clf, target)
            identifier = rfid_tag.identifier.hex()
            return identifier

        time.sleep(1)


def cropImage(image):
    gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)

    faces = model.detectMultiScale(gray, 1.3, 4)

    img = None
    max_area = 0
    for i, (x, y, w, h) in enumerate(faces):
        area = w*h
        if area > max_area:
            img = image[y:y + h, x:x + w]
            max_area = area

    return img


def insertUser(first_name, last_name, rfid, picture):
    picture = base64.b64encode(cv2.imencode(".jpg", picture)[1]).decode()

    response = requests.post(url=f'{API_URL}/user/add',
                             json={"first name": first_name, "last name": last_name, "rfid": rfid, "picture": picture})

    if response.status_code == 200:
        print("User Inserted into the DB")
    else:
        print("The server is not avalaible")


def addUser():
    first_name = input("First name: ")
    last_name = input("Last name: ")
    print("Please scan your card: ")
    rfid = getRFIDIdentifier()
    picture = None
    while True:
        print("Don't move a picture will be taken...")
        for i in range(3, 0, -1):
            print(i, "...")
            time.sleep(1)
        print("Cheese !!!")
        picture = cropImage(take_picture())
        if picture is not None:
            break

        print("No face detected")
        ans = input("Do you want to retry ? (y/n)")
        if ans == "n":
            break

    print("Sending user informations to the Database")
    insertUser(first_name, last_name, rfid, picture)


def main():
    print("What do you want to do ?")
    print("1. Add user")
    print("2. Edit user")
    print("3. Delete user")
    print("4. Exit")

    cmd = input("-> ")

    if cmd == "1":
        addUser()
    else:
        print("Command not implemented yet")


if __name__ == '__main__':
    # Init RFID
    clf = nfc.ContactlessFrontend()
    assert clf.open("usb:04e6:5591") is True

    # Init face detection
    model = cv2.CascadeClassifier('haarcascade_frontalface_default.xml')

    API_URL = "http://localhost:3000/api"

    # main()

    img = "0x2f396a2f34414151536b5a4a5267414241514141415141424141442f32774244414149424151454241514942415145434167494341675144416749434167554542414d4542675547426759464267594742776b494267634a427759474341734943516f4b43676f4b4267674c4441734b44416b4b4367722f327742444151494341674943416755444177554b4277594843676f4b43676f4b43676f4b43676f4b43676f4b43676f4b43676f4b43676f4b43676f4b43676f4b43676f4b43676f4b43676f4b43676f4b43676f4b43676f4b4367722f774141524341444f414d34444153494141684542417845422f38514148774141415155424151454241514541414141414141414141414543417751464267634943516f4c2f3851417452414141674544417749454177554642415141414146394151494441415152425249684d5545474531466842794a7846444b426b61454949304b78775256533066416b4d324a7967676b4b4668635947526f6c4a69636f4b536f304e5459334f446b3651305246526b644953557054564656575631685a576d4e6b5a575a6e61476c7163335231646e643465587144684957476834694a69704b546c4a57576c35695a6d714b6a704b576d7036697071724b7a744c57327437693575734c44784d584778386a4a79744c54314e585731396a5a32754869342b546c3575666f3665727838765030396662332b506e362f38514148774541417745424151454241514542415141414141414141414543417751464267634943516f4c2f385141745245414167454342415144424163464241514141514a3341414543417845454253457842684a425551646863524d694d6f454946454b526f62484243534d7a55764156596e4c524368596b4e4f456c3852635947526f6d4a7967704b6a55324e7a67354f6b4e4552555a4853456c4b55315256566c64595756706a5a47566d5a326870616e4e3064585a3365486c36676f4f456859614869496d4b6b704f556c5a61586d4a6d616f714f6b7061616e714b6d7173724f3074626133754c6d367773504578636248794d6e4b3074505531646258324e6e613475506b3565626e364f6e7138765030396662332b506e362f396f4144414d4241414952417845415077444f3262384f547478324865706f6b5656476566656b45536b3533484170634d6934554850595972486c56394473324f542b4f487866384f6641763457617038552f4552646c734173646e5a7142757572695137593477436565655436414539712f4e5477586f66694c347a6646615738316b54583270617465505063336b6f3773785058304134413741437666762b436a6e7868742f476e6a6e542f6848706e7a6164345a6d6153376d5755455846334a47426e6a2b344e7966556d6c2f59702b485a6b753576476439624a35586b2b586168757049507a4e574f4c6e374b6c794a3673396a4c734f70576d3065782f444c344a6547394730533330545374504d634d616a7a4a5279306a6453546e7658706d682f4450776a6f324a4c4c525955592f78794173632b7650725548682b3469736f7862524c774431726f52654177346637326543443072776d724c552b6c7077557452396c6f3970417a424556546e5079316574317334697a4e4347626a685231724f2f744663425375572f7656506133343342517635566b6455494a4d32374b574b535459534f4f6967644b76457849506d594450577349584b7132597a6a767761737833356e58664a494f6e3366576e70633139307670706d6e794b3068675573546e49715343327449766d6a694139434f3156626534574b334d786b3537416e72553661676968574b48357531614a6b754b36462f374f6b6b586d78706a487233707257554e7a6b7341324f546e734b722f327041634b6a48494853716f315553536b6f5467446b45304279743649333742726541684932424a3549394b316262565934794d707966537550572f6b566c65496b48504939616e2f414c525979594c6e64373944553832756853677a30505374616a676b447249415230494e6468346438585068595a57326b5038414b464f636976476244584c714a643861597833595a7a573359612f4b7a4233636b5a794e70775256516d3039534a30334a575a3635722b76726661466457724c6853672b592f7863394d66682b74664c7637556e77702f3454337736327332566b47766245664f414f4a5968304239776568375a72335333316c4c76773963475334426b32714977652f50503656796970486451537858507a6a6b4d4332636a3072563265714f4e303758566a34742f5a6b2b4f74372b7a333437767643586a65346c6e305857372b4b4d627a38756d794d7755534145384c672f4d463639612b33493842473267486e686c4f5177374548304e66486637552f7770735631693475486958597370614e31343341386a3842302f43765750324a2f6a5866655066436437384e66464633396f316e7734717446634e674e506148675a486370786b2f375665356771386131477a335238706d4f476c53716336366e7478456a4b4d743953525378342b3675632b754f4b5654744757504248536c534f557776644d45534a50767a53534b694c39537841466263736237486e4a6f64676b5a417a394b6479554250506f5053685970493045676b6a654e686d4e34705664542b4b6b696c4a494162622b74446767757a7861383158526448525a645a312f543749534e746a4e37667851377a3742324250345648346838516156345230473838573678637162437773354c716565475257557871704f51774f446b34413537312b633378722f613662342f664671782b49756b61544a704670706d6750706c765a51616a357a6a4a6e597937397134795a686b416368427a55326d66747236354e2b7a59663258374c7737484848466279513375744e63487a586a6b6d61556f735934586b347a6b38646765612b687135446961474757496c383132504b777561304d546933525735357666363372667843386354617071456a2f365a714539314f333935544978413975445832722b7a7a7063656a2b45375332733759787772414651453839636d766b66345761522f6175714b743075496b666c6f313764514b2b7a66686c4d4c6654556b6b55426e68584342756c6643356e58353854796f2f526348536a444471783231767145734f6f715a43414d2f647a327263625570586a586132414f666c726962322b6b69756c62492b5935504e62656d586a5041495335506f51656e74586c72335871657054676c473574573935644a47374d32345a7a6b6e705531727146775341754d656f724e74357874387554504a72537362554d51466c4a48387154616578707a4b35657472713453584c45454663644f687257526f356f77554f546a6b3158307a545275387034386e3139613146303257434c657359774f70484f4b3035436b3953764847307758596563394b756942724f5175376867526a4248536d7270302b4d5252486e6e64307050733830536c35564a78305055552b57364c32484e354a4f354e32506274532f5a6f35666e516b414471744a61743568324b6e507142562b3374324f4759466339414b7061614265784246707477426d4d597a3150635649697a786b78535259326a7152307252746247634f43333350584e6163656c57307241797267743350656c4b4f6f6e4a48503231794558456e5830396174322b70465156414158746b567033756732786c41554141446a6971567a704b77497a4b2f546e70326f57713149756b58394f313251495945516e63754d5a3470396e65626438426b7952327249745a47687a7359442b744f6a754373346c6473482b4956555647354539744469506a78346467313277794c645178797066755152587a70344438656e34436647327a2b4934734a4a724c613974726c6e4169744c4c4278765641784133456854314854714b2b726646715258566a4a4a4b4f526e614236347235672b4c2f67324b366d4c5373596e655137354d6344337274775534303636767365486d4e4c6d704e6f394d76662b437250374c31684777755044766a5a746e422f346c74714f65652f32676e394b38412f62462f622f4150414837517333686e537668486f4f73576470704d747731394e716869426c655178624346585033516a6466373163786638412f424c5855727854726b6e697138746f37707a4c684c64676f44632f4b57786e4f613448343266736e586e374e646c70666956372b2f75374b2b76686272635452595176745a674d394d345538562b6c35626838686e5767303235646e73666d474e6e6e46434d6e644f5070725939792f5a4b2f62333066396d2f77647258672f7741586544726e5649622f41466e3762597044714d63435167516f6a416c67636b6b453441413446656e58482f42594c3464517635612f4247375066632f694a4d662b4f6f65612b572f3263763259582f6159385261725a52336c7771364c615133456b63474d7635724d764a59384162523964316532576e2f424c50545a346848504a6673793550377434794d652b477744585a6d304d696869503373587a6552353254314d3271346138587030506a7a342b2f4357772f5a2f2b4d4e39344238507975396b756a32313143307159664d71456b45416e427a2b6c61766a48344c3233772b2b433377392b4a714176652b4e59376d5738474f417148393242364e6a723631316e2f42514f4b57352f6172317931675653304768365a45344278676d445048356975722f414770744b54526632512f67566557385962476b6f7079334a4d6c757274676578357a2b46637561346973386c70752b725055795368522f74696261327459342f7743432b6b43797356754e7045736c77527463667767444839612b6b504339384962614f4b32504151444765523631345438467251613559717351796b5743446e706e337233545139506133746c614e647052515072583550586b357a625a2b74303752707178752f61586d66373535366a46626d68435239724b70475057735451596d764e5177704947527961376a53625343323252794651546a414a354a724b4c684c526d30586376615a6f6b31772b5a70436f4a474b324c585332672f64776e4955386b6d71735770576b434579796864765832716a7133693851495a725a747968546b716156726147735864324f766861464f476c3578794231713170326f3231744c74646956497867313533592b4e324b715764636b347a6e7056772b4d455751504c64414450474b714b61527437793350543435344748444470307a31714f534730445979636e6e614f396342622b4f497968587a6a375a354e6145666975335a41524d633979476f356b576f746e557446436e7a626772667844505772326d54524352524c6a48765845532b4c375a33435379416b6a676d6b62787a44456f456b6a4e743944526f396853673065686a5562574d6259597a6748475361634e5969743546553353636a494f376b6668586e6b666a734e4e73383743675a497a7a5563336a69334c74794363343639713035623769354a49394f68313230664957635a492b59303947533959787132344867686539655a32586a61775973706e4f35634562655257705966457653625a77307433734f667648705575435349616b64765034636c4f5a496c494857732b393039344d7554774f7071625176696a6f393079326b6433484a75474e7565536659565072647a6158455a2b7a7467507a7836306b6d63386c4b357a327352704c6242664d7a375634682b305859665a3943532b4346515a544330692f77372f6c48366b56374e714573397557387a377050796731357238666649663463333079523732514b79484838573459465852626a575465786858687a553954722f42356d38596144706c7671736e6d5731765a78516c537877336c6f7135794f65635a2f47764c662b436d3368753166396c684c6d4746662b4a5a3478302b595934345a4a6f2b763061765466674c39743144776e7033326533486c787742647a75426e4855636e31726c502b436a3969662b474e66466e3274554573563170397862714a56334570644a6e414235344a2f5776744d427a5046553348756a3839783653703146366e6b582f424a7537456678523858365038724338384a527a786a2f414b35584b412f2b6831393032397248733365526e505964712f50582f676c35346a735044337839743574537534376533314c777671576e795846784b456a457637715a415759344754486a6e75514f3966667838552b484c4d37626e78626f3058542f41466d7332362f7a657663346e7063754f546a3252382f77335555734b2f566e34376674586645545166697a2b3048346e38632b434e516b764e4d753437614c54376f77744835717857364957437541772b594e3146643738652f6a44384f7669763841732b664450774a344e317a7a64573849365a424471316e4a617949493542624a4577566d41567747553871545868393334473158774e346f312f776271624d3075677953517a6e7674554c7a2b494972314f62396a37784838506668536669715a3544444e617858743541484446456b554d4735484141497a6a4f4b39444f7164434755513132324f66496173316e45376e6f48374e6d6c78782b45507445712f764841424a3952322f577656624f385a63513450484178586d76374f73346d2b4869454574354e773464682f466e6d753654552f7331753130646f494249424851562b4f563557714f352b79302f67534f32306c4c545476394a6b6e436a4753585041724538592f487a512f44636873346458684950444d6d53636568394b2b6666696c38633962686c754c533176356f3147514567504f4f784f61385938522f464c78444649576b646c446b35613462494a2f4f75655371542b4139476c526a43504e4e6e317465667454576b61535332563670494a327335425838525751333754316c4d7a7a333179544f564764677770486f426e69766b48562f476b4f6f782f5a3331554a3577784a7559425650747a584b616c346a3162545a5874375058704a497433796c5a696678363176546f5670626d38362b477078756a377548375366683363412b755730484845556b2b43545676542f6a3664516d534b4855494855743870344f42332f47767a3458784a7175346d613565554e3133766b2f7a72706643506a54786e70704432566e504a437244664b7354454b50516b56724c4456653546484734575574543945644c2b4b6b6477322b576441414f434734617432312b49634c4d6769756c4950634e6a4e664533684434733638397371535773795268734c4d6b5a4b3864636e74586f57672f45793766597958544d414f53422b7463377646374866614d333772507037562f4637665a4463527a5a4141795133497249583472525745626965346a4742315a36387754572f466d72364e35396c70313059517637795952486e6a72586d666a72785472746c5a506458336d52494267755467443865314a71553361496c4666616150646645333753316a345a5753614f366a6151484779516366354e636e642f74766546394a74665031654b59794d78336f6832717634313874654a66696470397548696258316c5a776436497863697554766459742f454c4b4c6179314753446776386f54662f414c72484948355630504356394c334f54455972435564464b37386a366976503238644a6b31646e304b79755851442f4146686b357a3641442b74614f6c66746c36314d79334d3967495663674137797a6669704f446d766d50773534537649774a744f306441574f51383130576344734342675a72733941384961747153713139634a617938376e53454e6e32475456546f4f316c493549592b6b3165783946614e2b315a346b314f66375470346c526c2f316b694d564239754f6c656e2f4141382f61313851445a427165724b766d6e4f4a6c42584f66706d766c625276686e504b51353859366c626e30684b71475076785773336753625464747a62654b64575141634f6267456e394f4b6d4e446c57347672744a364b4a2b67586862786e642b4c394c687562363243764d4d493843456f2f304a7a6a36566866476e54316d2b46577643434e684e425a43534d73442f41417949542f34376d76693351702f695a5a756266773738632f452b6c7534797067314354412b6f444372586a7234712f746a2f414133384d3347726170385839533851614173654c36356534334c47684f50336b63674f463577534352307a585668384e4773374b61544f44455971554974714f687a2f414f304a34542b4e33696e78784a71666776527268724151526f6a72637570586175474f464f4d45355034313570722f414d4e766a6a6f6c6d2f695878626279437967472b55797649364b6e39376b6e483172366e2f59662b4f2f6a3734772b4b64532b48766a69654b35737250515a622b79574f335264736b63384b594a56526b455348673572333734702f425854764648774d385a52616e484c47383368585547686a5137565569336b4b6b6764656345443246666435666a612b584f464b5555307248775750705573567a796966446e677a77333467385166732f51366c6f586c6661726e7857326e51733065386b74423567554431794b57782f5a6b2f61705a5162665746574d726c413971306d426e7067416b646137762f676e2f414b725936376265462f42477152627476784c30752f5a5034646b6b506c64505864747239432f2b46562b45594c695256307263797356336561774f41665969766f4d357a6165457170525331386a35444a634243764761374e6e35626645585472445750326e666a52464867726177366955782f77413949354c65506a2f783676752f586641566e34752b4663766757614d424e55384852325341415a55745a71464939773244583532613334714e702b3054385564596a54654c2f58745a7474704f636f393032547877654144583661786c4c473173376d433574336a677372634c7575555863466955647a774f4b386e50493149344f6a463757505979694d4b654b717a7672632f4e6677372b315a6f6637506668686643756f2b444c6e56373261566e32666178436b62443557556e424a775236657463336666746d664837346a7a54322f677a77356f326c577967447a494c59753041375a6b6b593550346668584e2f746b65483765782b4f6e6a4c53504464704e6436627058694b3465333143325176436b5570443753366a62777a466339794b312f4248686577385065424e4c6b6974336637625970635475442f45335050344776693675416f55344f636c642b5a392f68612b49784d6c464f7973593271512b4f2f45442f41476e785638534c71575754373064724549312f456a4766796f7350687034516b6455314958567849526e4c546e4c66584653617271317061546e6577776a2f41434b6535394b70503434306930686562564c316a4c794937614538442f507658493550614b736a3171634a51667675364e6b66447277616e37714b7a6a486f482b5967566a367a3444384d3664624e4a476b556d776e4b694d672f6e574e646647433574704d36647036786f4166766e6c76725766632f4750784264526d435262593542444552597a6e3135703874612b6771316243374f524266364e7061536b5730696f6f504c4850465652613268634f742f4c4533704533422f5771636d71766438794467656c4a444f6a76744d6d5053684b616c65356e7a346561555562567463654e624749543656723938467a674b737a6266797a696a5376695238563772553474473050784c71445845306e6c787852533763746e7036443631623043524a6f54426453536252674462337a585a6673782b46626257766a6c65327632645a646c704a35436c636e63374b4d6a337753507872746f314d50486d397047356c693646573846536b3164366d7634662f5a372f4147702f4774682f6157732f456e3749442f7978767645457a506a3245653566777a586e48786d2b452f784d2b46656f512f384143615859756f7032496776594c7470593359645679774242783249723946504176775975426f537a496b67627551506c512b6e76586833376133772f6d2f34567471656e3361435437414576376166474e724b2b31767a566d483469754b686d484a5856344b7a386a664534425477396f7a6431356e7a6a34582b45734e6c5a523670346f54353572645a56562b6744414d4d65707752566d39313572614957566e5a4265794b5239774476785871657565464c54575041576e654a724d59744a74497435392b37474d78714350774949727850786a71317931334a625730426a6841416152567a76487237567469613771566d7568574777584a527561647634796177692b3136787177695a44675252675a49396833726f76442f414d627641397336523676716c3456485178515a4972796a576449654f7857385463534438326574596a6c6c624a37566d734e47614f4f7269355965546a613650717251666a33384e4e576b2b79773637505a42686a644b6576343971335a2f47746f596762505859372b4276757445344f33363472777a344c65444e43757644567a726e694f50664a4c4c356476435a4d4859414357782b4e644634663841436638415a46362b6f2b484a6a48477a6378746b38666a55314d45344b375a31345845787847735565793247704736327a576b6f6b59723155666572765044347450456d6b5034623852716269797534446233556263686b5959492b6f366a3341727a4477564534434c4b6d30374f63487161396c2b454767586571366a6257397645464c4d42474a42786b6b59726d5353324e5a79736d6d5366384570764330476c364c38513562374a314b33385332326c7979487149496b6d49583857424a39634430723756754e4f683162527233534a5141743170747841636a6a44517376384157766a54396a337778386376445a2b4e486a6a345265464e46312b32302f78396372633646663355734e31645044765943335a53454a32794e6c57497a67594e6378662f41504261335749495773724c344c6146623349426a5270622b34596f33494f35654f6e5047612b73704b706a4a78396c713944347246595a344f6370543069336f655a667361654b34764376784530355a4a47575333314b32644f5034344c684f6e347258363358724a48714e78473541437a754f422f74477678542b462f697150535045567634706a437a4e62336b6c7745565375347357624135364174363968583150462f77576d3853744f3046373442384e4e49672f6579447a777a4e6e6e494c592f4b76736336796246347568536e5356326c7271664235566d564c433436744233356233305238512b463959757447735a745769697955746d4c37324f6359352f47765a596632615042306e7777747645576f2b494c7134313237736f377534747265374167674c674e35506c6a715642354a504a423656347a70566f4c69304d456833466d3267352b396b313666346f312f7844345174374c785a5a7556745a325331756c4b6e6249537642483467316878506a613246792b465347397a36486776443462485a70557056657578312f682f3463324d5037496e6a72546e587a4c6c7265376d575649384b4567696a6b5542522f754565326134765262426d2b476668363774334f473057333536383765522b656139322b444d6133506761485337347159723257654f3656683057543557422f41313554384a5044636366772f66776e63534d397a346431752b3075365058623563785a663066394b2f4e4d526d4478564e755431503071474170346645577037493875385265456f372b517879514e787a68584f61356e5550685951786e7444494163375659357858767478344d45425a746d3473656a656e7455467a345569654e58466d71494351477a3934317951714a52566d6454687a4d2b634e63384e716c736c7435424444713638354e5a63666766555a6473676b6a43743333632f6c5875766948776f74726462785a6279564a3455625437566b586e682b77686c575936516f5967626758326b48755258543961563171633073466836732f6650505a504167653268736f5643737135655163352b74564c6a774a64326a344d34396756354e6568583937702b6d466f6f4c4e3241484c6271704854764566694674326b614c45734959664f306f415035304f736a6f5743704a614c59792f426569584d45506c7a714749664b376858632f737133397462664857367672567973333236474f4f4e6568516c692f35625254625477326d6736584c712b7454717363455454532b576334326a4f4b6f6673786150665776784950696535526f35532f6d4f6a4c7a47736d63456a3342346f6a4f4d3663755a69355a2b3368486448366f664436373077614b3751326e6e514d666d7776663172356e2f344b44615a425a2b456a714d4a2f305334615333764938634d4755734150797236662f5a3874347451384d573173706a5658685668493577434d6454586d5037666677387466456e7776757270494e78686c52585548473075646f623277652f76586e5135597a54756569366175306b664333776d31765864662b434b3652617338763969547957317a62737553465a6d6b52736463454d522f7747754a385132755a6930646e396e4d624651476a77546e325061766f5834652f434f352b455130627862664257303778556e396e616f794d576a7435397a4732636b394165567a366e3656332b702f436e535a7255336830694b5a67707a356b594a48714d656c646a6c434e546e54756a6b707a6e5270576b726e784a4270567a6433757838744777494a4150796e485770725477467057377a5a64506b6c666638414d7a526e424f665376724e66686a345265597854364a45727375565567416a36436c682b412f6832456b705a47507a44386a4135417131585564557a4f70476a4e33617365422b482f4344576f52326a4359584156546a41394b394438452b44556e6377655765414347494f4d31302b7566416e554970522f5a72537971704278733267666a585a65412f683763325673736330667a6a746e763739367574694f6547724f574d59556d2b526c547774384f6f4a356f556c744d736e472f4f43507972327234556544426f6331735931494b54695465663456484a2f49436c384665423544455a70374d4c6c527334354876532f744a2b4d4c54344e2f7339654a50464545346776376a54323037526c44346553386e58594367366b71705a2b4f6d3275436264744336616c556c797338582f5a762b4c486a44772f34576974504439383853664562346c6174714a6e6a5870437278717a4b3266396a414849354e664d3378492b46656a61683479767458534742594e52314f3675563253675045686c4a4b734239334f6372366a36563967576e777a543454335877532b483979796f326c61426479616f726638414c4f5a777373725a2f77437572456653764a3130316448385153617a65323077617a75505064625a6f6a734c766933594673674257777a6a7376703172364468757136654c627671656278624b6d737569746a35373845685959707257324243784f7949433253414f784e6567614c3848394b317577532b58515532734d672b5365666345395237317955304e377033784238533247704e483972545635684f30556f64476d4c5a6b4b734f47586354676a673139422f43767850714e6e384e394a4d766953797370704957466a4c633672474669746b4f444330626762484c6b7944357556593864362f584d5a695a3038736a4b47352b447077686d73755a364d2b5776446f4d3976614b484a3879614f4d594f4d456b444e6570654d6447683137346358756c326179476147346a64464d7a4e7432734274436e6a504f636a31727a50777647456e30324c48503232487239334f396570723266534a314772794c65544b336d536e65354f515a4d3433652b61385469584471726c6e733376592b7134587853776d624b72356e6f337735766e4f6b72434a73474a6c4256652f796a4659477157467434462f61476c6c75725578365a3851724257676c5837736571512f6642374465764f653561727667573868732f456572366377495839314c41762b7a79435031465850697a34557366696e344c6b38493363766c7952544c6336646441484e764f765267527a7943516672583433546971636e54503274564656716338566f782b70654635414335556a3573454874396178352f412b6f6771366b757835324138566d654750326839532b485545506862396f4c776671586d524b493476456c726831754d644377364d6364383539526d753938502f46333447654b49772b6a2f41424730336344383064314c354d675070746573587a30366a5452616a2f4c716344725867533845536b4a38344a336865635a726d4e55384552686d4c453774707a6e3172322b343162774c64544d492f46756a75584a4c442b3159736a323561754a38596174384f624b5a5a626e786e704561717844532f62554a41396341394b364b63314a57513352693364706e6a5678345a6b6b757748526771743149786d756b305477344930426132595241634c47656c532b4a506948384f4c53344b61567178314b61542f565236664875446669656c476a326e784238634837466f476e706f63522b2f6461676376742f32565876374846613149546c45754d4574684e6538467434763165792b462b6b584730616a6966566e5a7562617a526c4c5a505a6d364156322f6858773946346c2b49323377355a4c4862527a72764b6744354938445a6b44302f72563777623454306e34642b48356c4534754c36595a764e526c3565596a70312b365038415a4664742b7a35346153333032572f68674a6c7637706e3348706a50465963335276593070303147664d7a366a2b424673747661576c70486c565542634b4d6c663835713538595043396e346b3058556448314257387134746d512b3548495076687566777170384c34356c2b7a77496e6c6838412b35376d75363851364246655757785a41306858475436314b566c7164726161506a6e515044693676345a314c34512b4f624f5a626259595843734179726e4b756a482b4948444b6578465a6e68627864463850627450415078613136337472364d376248575a435674745369353279627359523859444b324d483631366438652f44542b4850454670346c6a746a447555785849555944456664503563666c5848767165692b49375557327661566133567534784c6258734b7949773977632f6e3172574d34783061304f65704654304c2b716543724c58375a646230745935786a3933635738675a436659726b4771756e3666655753685a6f684a74507a456a69734b7a2b4450776d6a33766f454f71614a4935502b6b654839616c685a4d6e7372466b2f4446615678384c6459746f2f732b6b66484c785a42434647546579515473667164674a717277657a4f47705135647a72644f74595a696a655565655274465377364e61326c346269346c6974314279576e6b43443832497268376277527163575939532b5048693859474162466f4c646d487551704e51335877692b472b723355637573617a346831346276336f316e58586b5676776a436b666761476b75707a6577584e3548704f726674482f422f3466576632656678413272332f434a6f2b68494a35354837414849586e314250304e6368592b436669392b30463853394b2b4b767831306d333048776a34646e382f7778344a6b6a447a7a79352f317478752b5a6551704a59416e41554b427a58592b43394f3845654137415265446644476d3656386f784a5a3271724b654f386879352f45316f5858696b544d436d543875532b374f34314d70775871625537775453572f55342f77435031796961314434767670435a645030365a345739544932503149417277483754346c68766c476a616d556d44493972492b6e78456d3966647669352b2b674743705939633843765a766a50652f62504357707a65583568534b4e56526a314a6b4848307277364f35627950375053464275696142626b57784a4f37494d685938466b7a77653166536350306e37302b7038647852566453436f766f655065494c57445466696a71396a6133303178477371756b39306943566d4b715a46594a3875512b345a48424146653066416a2b31726e775048446f656f7952544365553379535764764e46393869505a35697351647537506270586a3378486a733758347733777462474f4a6673304d634c51323569535245554b4a416835473467736338357a6e6e4e657266416732576f6544376a544e556c5743327464515a306e53416c336b6451537551527741427837312b7156494f6554712b352b4f596e32644c4d2f65322f3442344a344f654d617a6f36586173305976346a4c486e47345a35414e657478616a6347374d7373675935323544443775666c48766a6a4e65536543764e54784c6f774b37354575314b416e6a6341534365334278587142764250656956452b586e446267536637333035726a7a6465306a45396e414f4d616a6439662b43644d6645556d6e654c4c4b364a776c3470686b6c4a2f35616451506f54585354362f64513341536467434279414d563568342f754c6b6547624857624346316d736452696c637463724a75584a78674c30375a4272583062576e3161334636307a7357417953656c666b7562344a5962454f61576a5032724a4d58484659534c3748636166346d75664e6b694a776a6e67455a422f41307165482f414144346866792f455867585337707943424a4a5a706b2f556744383635754f2b574e4e73737650726a675672365672456262437266494f72456331346b6e7a624876714e4e6d2f5a2f427234492b596e6e2f4337536c412f774357586b4842397a7a57745966434c345532456933566c384f39436a4348686d30754e7950785947714768584c3345766d524d65546e6735466470706b586d57354530794674755758302f437334717246364d726b666335485866442b6c4e4e35476e615262774965416c766171672f5141566b334f6d506f39717a5778594b6e4c41386e3635723053384e6845675a347544314f61382f38416964713657656e79765a457478386f2f765663707a35645336644e52566a6d593537377864726b58686d7838777a536e393271486e48632f5164362b6c504176686530384a61505a3665655574345658636570343550346d766c6a344a2b4a626a5366464f6f654b727043727857786a676a6b50584a366a3272755a66326d64532b312b5572417172595037773472503274766474646e563743556b6b6a3634304478725a3663493437636853765352753335647136625376474361684e3552764534797841395365612b51495032686c6b6a573457345a754f67414766774e6265682f7445514f70615a5742484a4a4f4e6f7156586b6e617858316578394a2f465077396f6e6a6e77374e706c784f466b4b596a6c4a4879746e67343767563879332b6d61726f47737a614664784b3073557a494e76523848686c3951657461342f6165754c7476496156456958674d7750492f437064573133542f462b6e32336979785a667456764b59324b6a37366e6e39442f4f745a564974616d4470546737737136585933674b78334e713847663457485838713247744c3949797249373864436158527459445147316e6733456b4663396a5852323030636b61686f774f4d5a7851716b5a49786b35374d3458564c4f2b4444455a7a6e6b41644b627039712b6e7a4757574e686e714d643637545779734e73667373616739386a74584b616a642b5770773253656554576932324d556d39316f53586e69415773473933494f506c487054594e636b654653626b446433427a57506553506379695a53534d394457587132756e544e50764a356b327244455a4e77376b447053747a4d68796a48517976694e3433686b764e57304435326e4c777851757834355559493967657463525953704c637462584538594537694a464e347757446132585941634d584879354950745662542f456c353469732f37646b6a6553535355715851427348766b2f51316330714b534f475751365a6578504e59435335647049302f304a43434d71547932396763666539754b2b3579616c4b6e515473666c2b66596c564d624b4e396a7966343078334d487851734c785a49424864366572573976464b374e41697555435362674d4e6b45385a47443172304434427130396a71646c4c724e6a4444466371363231354e49706b5a6c475858597263414b41632f7742345677333751385531763479304f3476546466326959584e394c647a4268496d56387261414d6a436a484a50474d59785855667337617434653037556457667843737a4c4a4244396d6146384871322f4f516638415a72394c706331584b6248356e6d5546395a54762f567a78614c574630547962376b4f6a426c4a4841774d316550787775354a424b69576f5945454b7941416e2f506174373442664278666a33385337543466586c77597255366463586c31496877336c784b446866636b6a384d313777663841676d78384c42496e6c3339336b5a4c6d53566a753941414d59372b74634f5a593343595755616458566e7434504265316735326679506e4c557632676f6e305a395075624f42764d6a5a434577526739635948483172652b45506a686456307458446f6f575861557a3178302b746539522f3841424d2f345353327a4753347567354844457551702b6d6347766e4c786e3850376e396e6634313674384f72356a4a414c654b367353716e426a644151516366554833466643352f5777754c676e535778393777727a34577536637232666339515336536152634d7044742b7461734e79786e65334b6b4251446b446735726c50424f733274337061544f36376d626a5055673472705a544775307050387a6e35523631384c4e726d73666f71636b37324f71384f36796b4c68596e5944634e78493446646a706574574572417a7a674d447a744f613875302b3976595269594c7965674853746f2b49504c6a525375333573746a6a49726971547155353648584233314f733853654a59595932696a7556624a2b554271344478426654366f786a554842626b45315066334676664d4a6d6c6b5667546b5a3630797a303962707470444d543734785665316374397a71676f38747a6750453935656548726a437a37524c47656736594e65503672343038587865495a627a544e587546506d6b526f6a2f41433439434f682f45563758385a394e69746f49376c5855667553534365773631346650716b4e7a715257307431534a75414f7554334e644e446c76646f6d62664a5a4e72304f75384e2b4e5046647a486d376d6b336864323762744766617570384e654e74647658524449785574382f6c6a4e6563614e64616863416931514f714d51777a365632656a616e70326a57336e7a4973627467347a314e565768445a4356656f33735a48693756666972716d75694b2b6d7646746f37672f5a49344d71705850422b587163657466566e37503057735850684c7a646344426c66393347656f58413550707a58673269654c4c622f41492b55556c41337a3775526e327236432b42577678367834586137437347615a6778486452775070555658546854566c71644d70314853615a3268697562632b6645335876567930316d3444434e766d42396152475755424734582b453437307632654978426d484f654e70726e6734334f47544c623356784e43776d58615037774e6337724d6b534d5335507a486734365674656358637737446873597a32717271476c2f615157354339736a70585247643373636a647062484f32384e7a49636b4d56446463567a50786b3164644238433363634d4f544e4738623768334b38632f5775346d6769736d5a5a5a2b7659642f70586d3378746e53505344475a433673526d4d386e47653961306c4631556a6d784877746f2b5674582b4c502f434e774451394e6a756f64716b65615277783738392b617a49766a7a34713077443748657963484b6c6f676366584e666f6c6f6e374a5877347439486867316e7768444a4949315a3558596b5373526b4d4d357743446e465a2b716673662f434f344a6365443042445a563932636577485376306641357451773942553344592f4c636467705673564b613176356e3538792f452f562f47742f5a786131387a327a4f30543741755378425054365632756c655074573848786661744b6644544b466b32784b2b514f6e336878587550375876374d766866346366424e76482f685477744a61505961785a7263585a594d486a6b636f563535484a5531355a38455043656a654c2f46456d6b3630686542644d655941646e456b5948364d612b3379724d614f49775571695769506a4d317761574b685435642f4d37372f41494a657836596632673955763952424d6472344b75396a597a686d6c68516366526a2b6466644e74646142634d7361674f65774d54663456384f663845766f6f5a766a6a722b5a454c663849584a46424753464c4f317a43646f7a3159685363446e6731397a61516b6b54474b61426b494f43724470587850464b6c4c48702b5239526b697668326e334e4b4f4c535a4977687430322b38592f777234542f414f437150686e5374472b4e5867727833593275794856764463316863517877625555775473366e70676c6849636a72787a5833316277695264786a58474f51422b74664e482f42574c34663265742f73725750697654374a4250346638575154764b5777786a6c5178465237456b452f774337587a484a4c6c61376e306c43723747764752386d2b426b7345634733424d5956574557656d6574647075746a78493233427a4675624247653165552b444c50575962755365386e41696b56524377594867656c65686147385a74635433537979416e4937676574664e34696e4745335a6e3231484552724a4a4d335942634d344c6a35517658474b735179482b4c4c46543935717a5a7269565656434858304f616e67757956494448676a4a4663556f36366e6f785572626d31484244637438385a554e2f463665764e5864485730686d4d694f5855635a50484663317147764b6c6f6b4e746334567362736e4a6f6a3153574750357076756a4a7765545552354737334e453562584f4d2f61503148375664665a494a6a48484445427642343348722f4145727833536247364f2b526f4267384431353769766250484f67322f69434e706b74336b643342783766537563742f4261366463412b57416f63466b4a7a6975326c4b4571576a4c636e705977644330695054495074306a375643343876503373315238526939676c56346e5a5935467963633936395073624477746432784d556b4a6b51664d6d3737333037315a50673777376576695455664a326a6c416736564d5a78684c55315363746b655a614a4871563830576a376a4845464c4d546e4c5a2f7744313139526673364c5070396e396831624d53694a58686a59344235485831794b346e77333463384c7871747661694b57546b4b63395439613949384c65464c7932525a684b376838417357786756453348586c42796e54566d656e5046466471536a46556a484b71656c50736f59576261477a6e7237566c6148505a365062665a37716338342b3863386972656e3676624c6573566c444276753754584e4361656b7457636333706f7a5457304b416b7841354850504971614f786a6d6a4b4b704f427a7a56694f565462433641414f4f65616969314649353972506e50336a5771386a6b6c4f544f52385a68724f305977522f4f44386d6539654b654a622b3538516549725053353767787a7a583853475471454a59415a72326a346a617a5a77327373387a686c69424d593648502f414f7575512f5a6738447434342b50635776334f6e4a63615a6f4965353142587756383652475742434f35335a62323256364f416f2b327843647a6b786c567777736d665752384e36786557736363476e4c47735545614e477a2f3676436759476554794b353778426236786f387132393970753154305a5a51613965434f30572b544a3338376a2f465847664575315151724938655353646d667058767a696f6454347871386a774839747634696158346a2f414751764766677931384c584e733632567649747a4e636f366b785845624443675a485472587842384a50484c2b446235645a61465a576c734769494a3447575275332b364b2b762f774272335776446568664348784834573133583743323144574e4865505474506d7659316e6c596b4545526b3774764235786976685454346234577363467246387361593450307239413454584e6c395750632b50346a6356576734364e484f78654b58734c434455726551695a5a56654a6b59686b4948444b527943443346666f742f774145775069783854666933384b4e66487846316d2f31577a3053396768305457645462644b2b39535a4c6665526d554a67486353534e324d3134442f7753692b4348774a2b4d69654b39562b4a2f6761333137562f447374704c70747271557a4e624343586572457767685a4347412b396b636a6976304b307654624454726144544e4d303231737253426474765a574675734d55532b696f6f41412b6c65586e6559304d5852564c6c39356454314d44683559576261325a71574f77786e4c5a4934726e766a54384c744e2b4d667776316a34586173497a62367a61474c644d44746a6b4242522b415477774853756b6852464979772b744c644b57565769376371516539664a4b55366535374c616c452f4a5379306a5676436c3171586854556e582b3164463153347362684d376c4c51794d68493952785853654639556c7562517464526f6a45383761396f2f626d2f5a693154775a34693137396f2f7778707348396e336c304c725534344a334d71794e67534f55493268632f4d63486a6d766e6944574362425a37492f492f7a486230727938626834786c652b6a5071736f7177396c5a765537324b34526f4e6b63774f463435794255306179474a6f79784250636436354877377253544a3562763135335a357258754c2b34534835574977506c4b3952586c797071396b653771396a4f7674635039732f5a444335436b636b344835567158327357456246316d4a6a43386e47445850586c784e6333596541677467345047545843654c745038596172644662574f54434444684a734b5231365a70527730584a6442387a366e622b4c766a54703974454c61795a664d5467756f485061754776506950716c2f4d5a59356b52694f72633548343168576e673358377955713668546e475766722b565755384358534150637a3835355665754b364934576a4471646c463469567557476e6d644c6f7669667934764d6557447a433251365344492f447457775069487038736f61535a743866483373715458473248674d336c31396d302b2f4a503857394d592f57746d50345769786a615336314e435034646f4f44557a6f78376e72304d50694a5354634c664d3648555048396861326950467163516b4c6a62354d7553443734365675654450326f66454868793746724c4a464c43783561526a672f5547755a30623456326c354a47646d30536a43376a2b74646e4e2b7a643456476e704a643337724b527762626e4f6535796636566e4c44785562584f3270684c7739394a2f656431705037536e682f774153522b565064524a496676716a2f644874697533384766456a7739657359375055347051426e7a45625034563836542f7330742f6166326653645a6e324142764f34557258622b432f43576f6542624e6f5675486b44415a65512f4e2b6c5a50435270713858646e69346e4430344f79566a3663306a57376536306f4d6c7743443135352f4b7336393135644f52376858477866764e6a6f4b38383848654a516c6f4c573775504c626e4d6d663070766a6a7864485936624a61523343727547504d4c357a52374f62566a78363046423643654b504573467a652b644953384c4d526875654d396139472f594b3863664454777848346a6c2b4950694730307166563734665a5a4c7959496b714a7445616a33487a2f6e587a4671586a65366b51365862546f4863375633386a48714432717a344f3850366c6533586e58716742546c56615141647565545874355452635a3671782b62654958456a79444178396d7561543665522b704e7271476c366e5a4c65614e7164766432324d52793274777367782b46633334314d514552754d474c636337786b416b597a2f414a394b2b4b50445869767842384f5848696252396638417344775933544e637146436a73636e70394b396f2b43763755512b4f4d736e6737554a4962693869694c523331746752746a73787a3150623861396645556d746d6e2b5a38467735783768383371716c5670536850767648377a383166326872543473614238594e5473666a425a5830476f2f326c4e4c396f766f795074555a63374a46596a356b4b34786734475077714c52645a4332325962704367347a75485776314d386466422b48786a706b6d682b4c6643397271567049754461366862704e486a32427a6a366767317a6e77772f59472f5a32304b4f6256627a396e76534c6957354256526678764f67554e2f436b6a46565075426e48664666555a4c784267384653354a4c6273652f6d575853786135354d2b50663841676a6a343647682f744f336e676564774976452f68793574314250576149435a50723931712f5336316a51664e745048657678352f594e38556e77662b31393850646138306f44346d6774704350376b78386c682b556872396962785a4c65615742546a5a4d7748353138376a573431303331506670525470496b32664d6348363070646f2f3476774e51704f75506e6261667055563166524c617663545478777878497a7a537a53684652414d6c6d4a3441414857755756534b4c6168626335623436654b2f416e686634573631715078496c692f736d57796c74707253515a4e34306946524369344f57505832417a3272386f724f2b6b384c695452376c697a516b69496875436d5467382b3338712b692f32365032724e4b2b4a75722f414e6b36444d662b456338507a4d316f534f6269344b37576d39776551766f76317234723852654b39543137576e314b533663446352456d3768467a774257574b7769727753504d775763563535684b4e46667534364e39333252366c345a3852334575734b4934675958424a5948424f4d3856325672346a686c743261346b775439314d354f4b3866384144326f79747064764944745a69666e4a34344e6458703273336f6861346b747a4a45426b4d57774d56344e62447a67394f682b6a3466473839465852752f61594e51314c626c3430552f4d46626e4272587437614d4b5a5741327232505531787731313375597438596841666353765842376539614e707237454746376f4e4a3147305934726e355a7033624f364653456b54362f59674b30746b356a62504a3634393635353772557849496f4d794548377754714b314c7a785573456a7853794a4a78686c3942564b313853324545336e79784f7979593874596f39784831506172697173746a30384a6a35556c626f503064645669767a4c627873725979785959466166384170306c30576c7657687975434279702f777246762f466b4d6c78747432644842376b394b6f79654f664f4a674c62555033766c357a55754e65576c6a36436c6e564a51545a36623464307258626d57326774377038717535514a507644745866365634593175514a635857734b6f5541724575374c6655394b3867384d2b4f4c695748436b74496941714332426a7078585632587841314e347365592f6c4c6a657179636731587662574b7135315471527445397230464c434974444a38353876686e4f41616f367a6461664973304d655156422b58504278324665655748784e5a34666b6c796d4d637479616c62786a4465414b386252684f51643263357243554b6c7a773631654e5356327a646931784c425a4a7a494d676d75452b49336a774839314a76436b6a42335a444836647174654974594d747578733162675a4c4876586b4878413852584b6661385259614d4b576d4c644353426744365a726f6f527154615672486b3471757153386a452b4a2f7741514e563161366b307532763253424d426847635a4f4f68507458466a56395551425266796b4c307a49654b58554c7072716470436335504a4a373158774f357236536a5435494a57507a7a4d716b4d58586370613969643958314f55596b753359446f43354e4c46725772775a2b7a366c4e486e723563684766794e56714b364647436437486d716a535851336254346b654f3752504c742f4765724943637346314b555a50723936702f3841686248784b55596a2b494f7472363764576d482f414c4e584f62546a4f4b544e5a657a696e657832787846525235545838462b4b4c37775434763076786870682f774249307255596275446e487a78794b342f56612b3774422f344c6261646658695034782f5a78433732427562725476456a626965374c47385750774c666a58352f55786d4f654430727378564746656d6d335a6d644771366273316448374c2f416e39727234442f744b68625034572b4d70463159516d6158773571304268765655646476384d77476571453863347278482f676f682b3068714f6858386e7748384a33696f3657636433346775554f546c766d53322f77432b64726e3669767a6d304c58645930532b6931445139536e744c754a77594c71326d614f534e756d565a5343507772307a3470654c64637662512b4a7462317137314455622b30513364376475476b6c6b4d5947356a33774142363856356b4b4d7154764a3352356d665631476c436c516255716a736356385250484635346875547030556a69434e38734332533763676b6e76584c347854736c354337486b6e4e42544a7950787274766f6234544330384c5255494937375139447572373458516172706c76756b6775706c6b5a514f32303450506f5269716b486936644c5a59486e41347738657a307275666741504d2b48303052436c5037566b334b77366e796f385679587857384f57656a61714c2b784777584a5a6e54504150734d635634736f78715670516b66615549537034534d34766f5762627852707075466a6a6d56336359434f6e335439656c57726936615241364537572b36796e6a3643754373705657355670636b5a375630647234696a466f6c7446626e4a6368533534466331664371456c796e5a68612f7445327a546c61347556414d4a636b346235656f487161753255577058397674303564775134594b754d4830717a6154716e68703774467732634d4d642f55552f7768713045712f5a3168646748792b3434796655593656696e434562486f51626d74444d3148773771525a59705947526a79374556567466434e303937734c3478304c7258586170654672675178676c647535512f61715770616e354d6356307341335a78747a67644f74524371373252736f795566654e7a777a34464c5048634e4941504c3273756356324e7034436d676a46784c475170487937774d483372695044336a715331514b5943355a54776654383636505550697a66573657326c5432697675776f596467656e65735a5456376e5247436e473573542b436256594755766a654f4176516d7565764a422f614357454d686679317a49796a6a7258553366694b56724f4b5a453279646a32727a4f38313639306278626362647252724556786a6b6b6e4e4f6a6162737a6d6e5535565a4855654a4e576969303934693438366643526f6f3645316c2f466a344857576a2f4157342b49666d5844586b553843792b624a6e3558596a47507156352b745a66776c6c7550482f78486a6a3147545a6252335371494637386e6e394b39752f6169736a5a2f737936396249343243347378744136425a6c7858625469366452507a4f4f727a314b636f394c4d2b48694e7245483170436d546e4e4c4c784d784871663530446b5a7236576c4231465a48775653305a4e4447556a70534472547a6e626e394b622f7444316f635846366b616442775948696b5a653470512f47534b4151526b564a56726f2f2f5a"

    i = cv2.imdecode(img)

    cv2.imwrite("test.png", i)
